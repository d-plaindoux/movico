type List[a] {
    model Nil
    model Cons {
        head : a
        tail : List[a]
    }
}

class ListClass [a] this:List[a] {
    (++) : List[a] -> List[a]
    map : [b] (a -> b) -> List[b]
    flatmap : [b] (a -> List[b]) -> List[b]
} {
    def Nil[a].(++) l = l    
    def Nil[a].map f = Nil
    def Nil[a].flatmap f = Nil

    def Cons[a].(++) l = Cons this.head ((ListClass this.tail) ++ l)
    def Cons[a].map f = Cons (f this.head) ((ListClass this.tail).map f)
    def Cons[a].flatmap f = (ListClass (f this.head)) ++ ((ListClass this.tail).flatmap f)
}
