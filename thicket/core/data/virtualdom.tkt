/*
 * Thicket
 * https://github.com/d-plaindoux/thicket
 *
 * Copyright (c) 2015 Didier Plaindoux
 * Licensed under the LGPL2 license.
 */

module Data.Dom.Virtual

import Data

type VDomAtt {
    CData { _ : string }
    MouseTrigger { /* TODO */ }
    KeyTrigger { /* TODO */ }
}

type VDom {
    Tag { 
        name : string
        attributes : Map[string VDomAtt]
        content : VDom
    }    
    PCData { _ : string }    
    Sequence { head : VDom tail : VDom }
    Empty
}

model Stringify { 
    toString : string 
}

class vdomAttPretty this:VDomAtt {
    +Stringify
} {
    def CData.toString = this._
    def toString       = "<function>"
}

class vdomPretty this:VDom {
    +Stringify
} {
    def Tag.toString      = "<" + this.name + ">" + 
                              (vdomPretty this.content toString) + 
                            "</" + this.name + ">"
    def PCData.toString   = this._
    def Sequence.toString = (vdomPretty this.head toString) + 
                            (vdomPretty this.tail toString)
    def Empty.toString    = ""
}
