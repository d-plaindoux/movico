--------------------------------------------------------------------------
 Movico grammar definition   
--------------------------------------------------------------------------
 V3                                                              1/2/2015               
--------------------------------------------------------------------------

entity  ::= objectDef | typeDef | classDef | viewDef

--------------------------------------------------------------------------

generics  ::= ("[" IDENT+ "]")?

objectDef ::= "model" IDENT generics (":" type)? "{" tparam* "}"
tparam    ::= (IDENT|"("OPERATOR")") ":" generics type
type      ::= IDENT ("[" type+ "]")?
            | "(" types ")" 

types     ::= type "," types
            | type "->" types
            | type

--------------------------------------------------------------------------

classDef  ::= "class" IDENT generics param "{" tparam* "}" "{" method* "}"

method    ::= "def" (type ".")? (IDENT|"("OPERATOR")") IDENT* "=" expr

exprs     ::= expr (OPERATOR | expr)*

expr      ::= iexpr ("," iexpr)*

iexpr     ::= sexpr ("." IDENT)*

sexpr     ::= NUMBER 
            | STRING
            | IDENT
            | "(" exprs ")"
            | "<" IDENT attr* ">" exprs "</" IDENT? ">" 
            | "<" IDENT attr* "/>"
            | "[" exprs ("for" IDENT "ingenerics ("if" exprs)? "]"
            | "let" IDENT IDENT* "=" exprs "in" exprs
            | "fun" IDENT+ => exprs
            
attr      ::= IDENT "=" expr

param     ::= IDENT ":" type

--------------------------------------------------------------------------

viewDef   ::= "view" IDENT generics param "{" exprs "}"

--------------------------------------------------------------------------
